<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Benchmark des pyramides cartographique</title>
<style>
  body { font-family: Arial, sans-serif; margin: 40px; background: #f9fafb; color: #222; }
  h1 { margin-bottom: 20px; }
  table { border-collapse: collapse; width: 100%; background: white; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: left; min-width: 120px; }
  th { background: #eef3ff; }
  td[contenteditable="true"] { background: #fffdf5; }
  button { margin: 5px; padding: 6px 10px; }
  .toolbar { margin-bottom: 15px; }
</style>
</head>
<body>
<h1>Benchmark des pyramides cartographique</h1>

<div class="toolbar">
  <button onclick="ajouterLigne()">+ Ajouter une ligne</button>
  <button onclick="ajouterColonne()">+ Ajouter une colonne</button>
  <button onclick="supprimerLigne()">– Supprimer une ligne</button>
  <button onclick="supprimerColonne()">– Supprimer une colonne</button>
  <button onclick="resetTable()">Réinitialiser</button>
</div>

<table id="tableau">
  <thead>
    <tr>
      <th>Fournisseur</th>
      <th>Type de pyramide</th>
      <th>Origine de la donnée</th>
      <th>Choix des données</th>
      <th>Généralisation</th>
      <th>Niveaux</th>
      <th>Remarque</th>
    </tr>
  </thead>
  <tbody>
    <tr><th>OSM</th><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
    <tr><th>ESRI France</th><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
    <tr><th>Maptiler</th><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
    <tr><th>Nexis</th><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
    <tr><th>Via Michelin</th><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
    <tr><th>TOMTOM</th><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
    <tr><th>Dutch kadaster</th><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
    <tr><th>Google Maps</th><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
  </tbody>
</table>

<script>
const STORAGE_KEY = "benchmarkPyramides_v3";
const table = document.getElementById("tableau");

// Sauvegarde
function saveTable() {
  localStorage.setItem(STORAGE_KEY, table.innerHTML);
}

// Chargement
function loadTable() {
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) table.innerHTML = saved;
  attachListeners();
}

// Réattacher les écouteurs après restauration du HTML
function attachListeners() {
  table.querySelectorAll("[contenteditable]").forEach(cell => {
    cell.addEventListener("input", saveTable);
  });
}

// Ajouter une ligne
function ajouterLigne() {
  const rowIndex = prompt("Insérer la ligne avant quel numéro ? (1 = première, vide = fin)");
  const tbody = table.querySelector("tbody");
  const nbCols = table.rows[0].cells.length;
  const newRow = tbody.insertRow(rowIndex ? rowIndex - 1 : -1);
  for (let i = 0; i < nbCols; i++) {
    const cell = newRow.insertCell(i);
    if (i === 0) cell.outerHTML = "<th contenteditable='true'>Nouveau</th>";
    else cell.setAttribute("contenteditable", "true");
  }
  attachListeners();
  saveTable();
}

// Supprimer une ligne
function supprimerLigne() {
  const tbody = table.querySelector("tbody");
  const index = prompt("Numéro de ligne à supprimer ? (1 = première)");
  if (index && tbody.rows[index - 1]) {
    tbody.deleteRow(index - 1);
    saveTable();
  }
}

// Ajouter une colonne
function ajouterColonne() {
  const colIndex = prompt("Insérer la colonne avant quel numéro ? (1 = première, vide = fin)");
  const index = colIndex ? parseInt(colIndex) - 1 : -1;
  for (let r = 0; r < table.rows.length; r++) {
    const row = table.rows[r];
    const cell = row.insertCell(index);
    if (r === 0) {
      cell.outerHTML = "<th contenteditable='true'>Nouvelle colonne</th>";
    } else {
      cell.setAttribute("contenteditable", "true");
    }
  }
  attachListeners();
  saveTable();
}

// Supprimer une colonne
function supprimerColonne() {
  const colIndex = prompt("Numéro de colonne à supprimer ? (1 = première)");
  if (!colIndex) return;
  const index = parseInt(colIndex) - 1;
  for (let r = 0; r < table.rows.length; r++) {
    if (table.rows[r].cells[index]) table.rows[r].deleteCell(index);
  }
  saveTable();
}

// Réinitialiser le tableau
function resetTable() {
  if (confirm("Supprimer toutes les données et restaurer la table d'origine ?")) {
    localStorage.removeItem(STORAGE_KEY);
    location.reload();
  }
}

loadTable();
</script>
</body>
</html>
